# 📗 Node: 模块 IO 架构

> **Parent:** [live_traffic_hub.md](./live_traffic_hub.md)  
> **Date:** 2026-01-21 | **Status:** 🌱探索

---

## 概览

链路：**召回 → 排序/出牌 → 金牌/加码**

四个可交付模块，每个模块有清晰 IO：

| 模块 | 职责 | 解决的冷启动 |
|------|------|-------------|
| 模块1 | 高潜主播识别 | Creator Cold Start |
| 模块2 | 开播启动期流量分配 | Session Cold Start |
| 模块3 | 人群匹配 | User Cold Start |
| 模块4 | 运营协同交付 | Marketplace Cold Start |

---

## 模块 1：高潜主播识别（Offline/准实时）

### Inputs

| 类别 | 字段 |
|------|------|
| 主播静态 | 账号信息、历史开播、短视频表现、内容品类/语言/地域、合规风险信号 |
| 直播间表现 | 首1/3/5分钟留存、评论/分钟、关注率、负反馈 |
| 其他模型 | 内容embedding、用户兴趣embedding、基础排序分 |
| 跨域特征 | 短视频发布频率、完播率、互动率、粉丝结构 |

### Outputs

| 字段 | 类型 | 说明 |
|------|------|------|
| `anchor_potential_score` | float [0,1] | 高潜概率/分数 |
| `anchor_tier` | enum | S/A/B/C 分层 |
| `reason_codes` | list[str] | 可解释原因（留存高/互动高/负反馈低/短视频完播高） |
| `actionable_list` | list | 给运营的名单（含建议动作：培训/话术/品类/时段） |

---

## 模块 2：开播启动期流量分配（Online，分钟级决策）

> 解决 Session Cold Start，本质是 Contextual Bandit

### Inputs

| 类别 | 字段 |
|------|------|
| 主播分层 | tier/score（来自模块1） |
| Room State（1-5分钟更新） | 当前UV、并发、留存斜率、评论/分钟、关注率、负反馈率 |
| 预算/约束 | 新主播探索预算、单场最大曝光上限、负反馈止损线、用户侧保护策略 |

### Outputs

| 字段 | 类型 | 说明 |
|------|------|------|
| `seed_quota` | int | 启动播种曝光量（Seed阶段） |
| `scale_policy` | dict | 加码规则（阈值→曝光乘子1.5x/2x） |
| `stop_rule` | dict | 止损条件（负反馈>阈值、留存断崖等） |
| `traffic_multiplier` | float | 给排序/金牌层的加权系数（可选） |

### 三段式机制

| 阶段 | 英文 | 策略 | 触发信号 |
|------|------|------|---------|
| 播种 | Seed | 给基础探索曝光 | 主播tier+品类 |
| 验证 | Validate | 通过门槛才继续 | 前N分钟留存/互动/负反馈 |
| 加码 | Scale | 边际收益好才加量 | 留存不崩+负反馈稳定 |
| 止损 | Stop | 触发阈值立即回撤 | 负反馈>X或留存断崖 |

---

## 模块 3：人群匹配（避免"大哥场景塞小白"）

> 解决 User Cold Start

### Inputs

| 类别 | 字段 |
|------|------|
| 用户侧 | 兴趣embedding、语言/地域、Live偏好、付费/互动意图分层、新用户标识 |
| 主播侧 | 内容品类、历史吸引人群、实时房间氛围（互动密度、礼物导向强弱） |
| 约束 | 新用户保护、低付费用户保护、合规风险 |

### Outputs

| 字段 | 类型 | 说明 |
|------|------|------|
| `eligible_user_cohorts` | list | 适配人群池（白名单） |
| `exclude_user_cohorts` | list | 不适配人群（黑名单/降权） |
| `match_score(u, live)` | float | 用户-直播间匹配分（供召回/排序使用） |

### 用户意图分层

| 分层 | 特征 | 策略 |
|------|------|------|
| 付费高意图 | 历史打赏、购买、强互动、深度停留 | 可加大礼物转化权重 |
| 社交互动型 | 爱聊天、爱评论，但不一定付费 | 加大互动质量权重 |
| 内容消费型 | 刷得快、偏短停留、少互动 | 更看重前3秒吸引力 |
| 新用户/冷启动 | 无历史，需保守策略 | 优先高确定性内容，探索比例更低 |

---

## 模块 4：运营协同交付

> 解决 Marketplace Cold Start，把算法变成运营可执行

### Inputs

| 来源 | 内容 |
|------|------|
| 模块1 | 高潜名单 |
| 模块2 | 启动期失败原因 |
| 模块3 | 匹配偏差诊断 |

### Outputs

| 字段 | 类型 | 说明 |
|------|------|------|
| 运营可执行包 | 周更/日更 | 重点跟进主播名单（按tier/增量空间排序） |
| 建议动作 | list | 每个主播1-3条建议（开场话术/互动玩法/内容定位/开播时段） |
| 原因分类 | enum | "为什么拿不到量"（留存差/负反馈高/匹配错人群/内容风险） |
| 反馈回流字段 | dict | 是否触达、是否培训、主播采纳、采纳后效果 |

---

## 模块接口规格速查

| 模块 | 刷新频率 | 延迟要求 | 存储 |
|------|---------|---------|------|
| 模块1：高潜识别 | 日更（离线） + 分钟级（启动期特征） | 离线T+1，在线<1s | 离线表 + Redis |
| 模块2：流量分配 | 分钟级 | <100ms | 在线服务 |
| 模块3：人群匹配 | 实时 | <50ms | 在线服务 |
| 模块4：运营交付 | 日/周更 | T+1 | 离线表 + Dashboard |

---

## 一句话 IO 总结（写进方案）

- **输入**：主播画像 + 短视频跨域特征 + 开播Room State + 用户意图分层 + 基础模型embedding + 风险与体验约束
- **输出**：高潜主播分层名单（可解释reason codes）+ 单场Bandit策略（Seed/Scale/Stop）+ 人群匹配白黑名单（保护小白）+ 运营动作包（可执行）
